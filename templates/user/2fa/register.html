{% extends "base.html" %}

{% block title %}Register 2FA{% endblock %}

{% block content %}

    <div class="max-w-md mx-auto mt-10 bg-white shadow rounded p-6">
        <h1 class="text-xl font-semibold mb-4">Register 2FA</h1>

        <p class="mb-2">Scan this QR code with your authenticator app:</p>
        <img src="data:image/png;base64,{{ qr_b64 }}" alt="QR Code" class="mx-auto"/>


        <div id="qr-spinner" class="htmx-indicator text-center mt-2"></div>

        {% from "ui/macros/form.html" import render_form %}

        {{ render_form(form,
                action=url_for('auth.setup_totp'),
                method='POST',
                submit_label='Enable 2FA',
                field_order=['token'],
                help_texts={
                'totp_code': 'Enter the 6-digit code from your authenticator app (if enabled).'
                },
                extra_attrs={
                'totp_code': {'autocomplete':'one-time-code', 'placeholder':'123456'}
                },
                submit_classes='w-full inline-flex items-center justify-center rounded-md px-4 py-2 text-sm font-medium bg-blue-600 text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500',
                grid_classes='grid grid-cols-1 sm:grid-cols-1 gap-4'
                ) }}
    </div>

{% endblock %}